"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const a=require("./index-Cp5RPJWA.cjs");function N(){return a.sa().name!=="browser"||window.hasOwnProperty("debuggerInitialized")?null:(window.debuggerInitialized=!0,a.reactDomExports.createPortal(a.at.jsx(j,{}),document.body))}const k=(t,s)=>{const n=t.dataset.yaAction,e=t.dataset.yaScopeoverride,l=t.dataset.yaEventname,i=e||s;return{action:n,originalEventName:i?`${i}_${l}`:l,scope:i}},S=(t,s)=>{const n=[];let e=t;for(;e!=null&&e.parentElement;)e=e.parentElement.closest(s),e&&n.push(e);return n},v={},w="YA_NO_SCOPE",y=(t,s,n,e)=>{v.hasOwnProperty(t)?v[t].events.map(l=>l.el).includes(e)||(v[t].events=[...v[t].events,{eventData:s,el:e}]):v[t]={scopeEl:n||e,events:[{eventData:s,el:e}]}};function j(){const[t,s]=a.reactExports.useState(),[n,e]=a.reactExports.useState([]),[l,i]=a.reactExports.useState(!1),o=r=>{s(t===r?void 0:r)};return a.reactExports.useEffect(()=>{let r=null;const d=()=>{r&&r.abort(),r=new AbortController;const c=r.signal;document.documentElement.classList.add("xYextDebug"),document.querySelectorAll("[data-ya-eventname]").forEach((u,E)=>{const m=u.closest("[data-ya-scope]"),h=m?.dataset.yaScope,p=k(u,h);u.addEventListener("mouseenter",()=>{e([{elem:u,key:`${p.originalEventName}_${E}`,action:p.action,originalEventName:p.originalEventName,scope:p.scope}])},{signal:c}),u.addEventListener("mouseleave",()=>{e([])},{signal:c});const x=u.dataset.yaScopeoverride;x?y(x,p,m,u):[h,...S(u,"[data-ya-scope]").map(b=>b.dataset.yaScope)].forEach(b=>{y(b||w,p,m,u)})}),i(!0)};d();const g=new MutationObserver(d);return g.observe(document,{childList:!0,subtree:!0}),()=>{document.documentElement.classList.remove("xYextDebug"),g.disconnect(),r?.abort()}},[]),l?a.at.jsxs(a.at.Fragment,{children:[a.at.jsxs("div",{className:"analytics-debugger",children:[a.at.jsxs("div",{className:"analytics-debugger-toggles",children:[a.at.jsx("button",{className:a.oa("analytics-debugger-toggle",{"is-active":t==="Events"}),onClick:()=>o("Events"),children:"Events"}),a.at.jsx("button",{className:a.oa("analytics-debugger-toggle",{"is-active":t==="Scopes"}),onClick:()=>o("Scopes"),children:"Scopes"})]}),t&&a.at.jsx("div",{className:"analytics-debugger-tabs",children:t==="Events"?a.at.jsx(C,{data:v,setTooltips:e}):a.at.jsx($,{data:v,setTooltips:e})})]}),a.at.jsx(D,{tooltips:n})]}):null}const Y=()=>{const t={};return Object.values(v).forEach(s=>{s.events.forEach(n=>{const{originalEventName:e}=n.eventData;t[e]||(t[e]=[]),!t[e].find(l=>l.el===n.el)&&t[e].push(n)})}),t};function C(t){const{setTooltips:s}=t,[n,e]=a.reactExports.useState([]),[l,i]=a.reactExports.useState(""),o=(r,d)=>{n.forEach(c=>c.classList.remove("analytics-event-highlight"));const g=r.map(c=>(c.el.scrollIntoView({behavior:"smooth",block:"nearest"}),c.el.classList.add("analytics-event-highlight"),c.el));e(g),i(d),s(r.map((c,u)=>({elem:c.el,key:`${c.eventData.originalEventName}_${u}`,action:c.eventData.action,originalEventName:c.eventData.originalEventName,scope:c.eventData.scope})))};return a.at.jsxs("div",{className:"analytics-debugger-tab",children:[a.at.jsx("h2",{className:"analytics-debugger-tab-title",children:"Event Names"}),a.at.jsx("ul",{className:"analytics-debugger-list",children:Object.entries(Y()).map(([r,d],g)=>{const c=`${r}_${g}`;return a.at.jsx("li",{className:"analytics-debugger-listItem",children:a.at.jsx("button",{className:a.oa("analytics-debugger-button",{"is-active":c===l}),onClick:()=>o(d,c),children:r})},c)})})]})}function $(t){const{data:s,setTooltips:n}=t,[e,l]=a.reactExports.useState(""),i=o=>{const r=s[o];r.scopeEl&&(r.scopeEl.scrollIntoView({behavior:"smooth",block:"nearest"}),l(o),n(r.events.map((d,g)=>{const c=d.eventData;return{elem:d.el,key:`${c.originalEventName}_${g}`,action:c.action,originalEventName:c.originalEventName,scope:c.scope}})))};return a.at.jsxs("div",{className:"analytics-debugger-tab",children:[a.at.jsx("h2",{className:"analytics-debugger-tab-title",children:"Scope Names"}),a.at.jsx("ul",{className:"analytics-debugger-list",children:Object.keys(s).map((o,r)=>{if(o!==w)return a.at.jsx("li",{className:"analytics-debugger-listItem",children:a.at.jsx("button",{className:a.oa("analytics-debugger-button",{"is-active":o===e}),onClick:()=>i(o),children:o})},o+r)})})]})}function D(t){const s=a.reactExports.useRef({});return a.reactExports.useEffect(()=>{if(s.current)for(const n of Object.values(s.current)){const e=Object.values(s.current).map(l=>l.el).filter(l=>l!==n.el);O(n,e),n.el.style.visibility="visible"}},[t.tooltips]),a.at.jsx(a.at.Fragment,{children:t.tooltips.map(n=>a.at.jsxs("div",{style:{visibility:"hidden"},className:"analytics-debugger-tooltip",ref:e=>{e?s.current[n.key]={el:e,tooltip:n}:delete s.current[n.key]},children:[a.at.jsxs("span",{children:["Action: ",n.action]}),a.at.jsx("br",{}),a.at.jsxs("span",{children:["Scope: ",n.scope]}),a.at.jsx("br",{}),a.at.jsxs("span",{children:["Original Event Name: ",n.originalEventName]})]},n.key))})}function O(t,s){for(let n=0;n<9;n++){const e=I(t.tooltip.elem.getBoundingClientRect(),t.el,n);if(t.el.style.inset=`${e.top} auto auto ${e.left}`,!!B(t.el.getBoundingClientRect().left,t.el.getBoundingClientRect().top+window.scrollY,t.el.getBoundingClientRect().right,t.el.getBoundingClientRect().bottom+window.scrollY))continue;let l=!0;for(let i=0;i<s.length;i++){const o=s[i];R(t.el,o)&&(l=!1)}if(l)break}}function R(t,s){const n=t.getBoundingClientRect().top+window.scrollY,e=t.getBoundingClientRect().left,l=n+t.clientHeight,i=e+t.clientWidth,o=s.getBoundingClientRect().top+window.scrollY,r=s.getBoundingClientRect().left,d=o+s.clientHeight,g=r+s.clientWidth,c=(u,E,m,h,p,x,b,f)=>m<=p&&p<=b&&h<=x&&x<=f||m<=u&&u<=b&&h<=E&&E<=f||m<=u&&u<=b&&h<=x&&x<=f||m<=p&&p<=b&&h<=E&&E<=f;return c(e,n,r,o,i,l,g,d)||c(r,o,e,n,g,d,i,l)}function B(t,s,n,e){return t<0||n>window.innerWidth||s<0||e>document.documentElement.scrollHeight}function I(t,s,n){const e=s.clientHeight,l=s.clientWidth;let i,o;switch(n){case 0:{o=window.scrollY+t.top-e+"px",i=t.left-l+"px";break}case 1:{o=window.scrollY+t.top-e+"px",i=t.left+"px";break}case 2:{o=window.scrollY+t.top-e+"px",i=t.right+"px";break}case 3:{o=window.scrollY+t.top-e+"px",i=t.right-l+"px";break}case 4:{o=window.scrollY+t.bottom+"px",i=t.left-l+"px";break}case 5:{o=window.scrollY+t.bottom+"px",i=t.left+"px";break}case 6:{o=window.scrollY+t.bottom+"px",i=t.right-l+"px";break}case 7:{o=window.scrollY+t.bottom+"px",i=t.right+"px";break}default:o=0,i=0}return{top:o,left:i}}exports.AnalyticsDebuggerInternal=j;exports.default=N;
